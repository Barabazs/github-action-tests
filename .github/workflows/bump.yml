on:
  pull_request:
    types: [labeled, unlabeled]

jobs:
  run_if_label_matches:
    if: contains(toJson(github.event.pull_request.labels.*.name), 'ready to merge') && (contains(toJson(github.event.pull_request.labels.*.name), 'minor') || contains(toJson(github.event.pull_request.labels.*.name), 'major') || contains(toJson(github.event.pull_request.labels.*.name), 'patch'))
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
        with:
          ref: ${{ github.head_ref }}
          # fetch-depth: 0
      - name: ls -al
        run: ls -al

      - name: Get current version and update
        run: bash ./bump.sh

      # - name: Commit and push if it has changed
      #   run: |
      #     PY_INIT_FILE_PATH="utils/__init__.py"
      #     sed -i "s/__version__ = .*/__version__ = \"$new_version\"/g" $PY_INIT_FILE_PATH

      # - name: Commit and push if it has changed
      #   run: |
      #     git config --global user.name 'GitHub Actions'
      #     git config --global user.email 'actions@github.com'
      #     git add -A
      #     git diff --quiet && git diff --staged --quiet || git commit -m "Update version"
      #     git push
